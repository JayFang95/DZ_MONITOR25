<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dzkj.mapper.data.PointDataZRealMapper">

    <select id="getDataByPidList" resultType="com.dzkj.biz.data.vo.PointDataZRealVO">
        select pdzr.id, pdzr.pid, pdzr.name, pdzr.z
        from point_data_z_real pdzr
        inner join
        ( select pid, max(get_time) as max_get_time
        from point_data_z_real
        where pid in
        <foreach collection="list" index="index" item="item"
                 separator="," open="(" close=")">
            #{item}
        </foreach>
        group by pid) temp
        on temp.pid = pdzr.pid and temp.max_get_time = pdzr.get_time
    </select>
</mapper>
